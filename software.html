<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>biotech - AI Lingues团队</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <div id="header"></div>

  <div class="container" id="software-list">
    <!-- JS 动态加载软件信息 -->
  </div>
  <div id="footer"></div>

  <script>
    fetch("/header.html")
      .then(res => res.text())
      .then(html => { document.getElementById("header").outerHTML = html; });
  </script>
  <script>
    fetch("/footer.html")
      .then(res => res.text())
      .then(html => { document.getElementById("footer").outerHTML = html; });
  </script>
  <script>
    const DATA_DIR = './data/';

    async function loadIndex() {
      const container = document.getElementById('software-list');
      let indexList;

      try {
        const indexResp = await fetch(`${DATA_DIR}index.json`);
        indexList = await indexResp.json();
      } catch (e) {
        container.innerHTML = '<p style="color:red;">Failed to load software list.</p>';
        return;
      }

      for (const file of indexList) {
        try {
          const response = await fetch(`${DATA_DIR}${file}`);
          const data = await response.json();
          const latest = data.versions[0];
          const softwareName = data.software || file.replace('.json', '');
          const linkName = file.replace('.json', '');
          const featuresList = Array.isArray(latest.features)
            ? latest.features.map(f => `<li>${f}</li>`).join('')
            : '';

          const downloadLink = latest.download_url
            ? `<a href="${latest.download_url}">下载</a>`
            : '';

          const card = document.createElement('div');
          card.className = 'software-card';
          card.innerHTML = `
                            <h2><a href="detail.html?name=${encodeURIComponent(linkName)}">${softwareName}</a></h2>
                            <p><strong>Latest Version:</strong> ${latest.version} <br>
                            <strong>Release Date:</strong> ${latest.date}</p>
                            <ul>${featuresList}</ul>
                            ${downloadLink}
                          `;
          container.appendChild(card);
        } catch (e) {
          console.warn(`Failed to load: ${file}`);
        }
      }
    }

    loadIndex();
  </script>
</body>

</html>